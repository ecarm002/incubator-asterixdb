/*
* Description  : Create an  dataset and load it from two file splits 
                 Use hint (cardinality) for the created dataset.
* Expected Res : Success
* Date         : 30th Jan 2013
*/

/* scan and print an ADM file as a dataset of closed records */

drop dataverse test if exists;
create dataverse test;
use dataverse test;

create type DBLPType as closed {
  id: int32, 
  dblpid: string,
  title: string,
  authors: string,
  misc: string
}

create dataset DBLPadm(DBLPType) 
primary key id
hints(cardinality=200);

// drop dataset DBLPadm;
load dataset DBLPadm 
using "edu.uci.ics.asterix.external.dataset.adapter.NCFileSystemAdapter" 
(("path"="nc1://data/dblp-small/part-00000.adm,nc1://data/dblp-small/part-00001.adm"),("format"="adm"));

write output to nc1:"rttest/hints_issue_251_dataset_hint_5.adm";

for $paper in dataset('DBLPadm')
order by $paper.id
return $paper
