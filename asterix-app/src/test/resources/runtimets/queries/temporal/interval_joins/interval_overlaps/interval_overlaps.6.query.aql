/*
 * Description      :   Check temporal join functionality for interval
 * Expected Result  :   Success
 * Date             :   26th Jun, 2015
 */

use dataverse TinyCollege;

for $f in dataset Staff
for $d in dataset Students
where /*+ interval-spatial-join ["F", "L", "R"] */ interval-overlaps($f.employment, $d.attendance)
/*+ range ["F", "L", "R"] */
order by $f.name, $d.name
return { "staff" : $f.name, "student" : $d.name }
