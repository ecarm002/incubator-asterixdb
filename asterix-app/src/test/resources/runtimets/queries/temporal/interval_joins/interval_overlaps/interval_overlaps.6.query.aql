/*
 * Description      :   Check temporal join functionality for interval
 * Expected Result  :   Success
 * Date             :   26th Jun, 2015
 */

use dataverse TinyCollege;

for $d in dataset Students
for $f in dataset Staff
where /*+ interval-merge-join [991353600000, 1054425600000, 1149120000000] */ interval-overlaps($d.attendance, $f.employment)
/*+ range ["F", "L", "R"] */
order by $f.name, $d.name
return { "staff" : $f.name, "student" : $d.name }
