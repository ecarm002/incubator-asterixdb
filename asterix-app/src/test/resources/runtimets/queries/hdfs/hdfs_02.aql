drop dataverse test if exists;
create dataverse test;
use dataverse test;

create type LineType as closed {
 content: string
};

create external dataset TextDataset(LineType)
using "hdfs"
(("hdfs"="hdfs://127.0.0.1:31888"),("path"="/asterix/textFileS"),("input-format"="sequence-input-format"),("format"="delimited-text"),("delimiter"="."));

write output to nc1:"rttest/hdfs_hdfs_02.adm";

for $line in dataset('TextDataset')
let $tokens := word-tokens($line.content)
for $token in $tokens
group by $tok := $token with $token
return { "word": $tok, "count": count($token) }
